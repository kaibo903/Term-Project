# 使用者手冊

## 目錄

1. [系統概述](#系統概述)
2. [快速開始](#快速開始)
3. [功能操作指南](#功能操作指南)
4. [常見問題](#常見問題)

## 系統概述

營造廠決策分析平台是一個專為營造廠設計的決策支援系統，首個核心功能為「投標最佳化決策系統」。系統採用整數線性規劃（MILP）模型，協助使用者在投標階段快速獲得最優的工期與成本方案。

### 主要功能

- **專案管理**：建立與管理專案
- **作業活動管理**：定義專案的作業活動及其前置關係
- **投標優化計算**：執行優化計算，獲得最優方案
- **結果分析**：查看優化結果、圖表視覺化
- **報告匯出**：匯出 PDF 或 Excel 報告

## 快速開始

### 1. 建立專案

1. 登入系統後，進入「專案管理」頁面
2. 點擊「新增專案」按鈕
3. 填寫專案資訊：
   - **專案名稱**：必填，例如「台北市某大樓新建工程」
   - **描述**：選填，專案的詳細說明
   - **狀態**：選擇專案狀態（草稿/進行中/已完成）
4. 點擊「確定」完成建立

### 2. 定義作業活動

1. 在專案列表中，點擊「管理作業」按鈕
2. 在作業管理對話框中，點擊「新增作業」
3. 填寫作業資訊：
   - **作業名稱**：必填，例如「基礎開挖」
   - **正常工期**：作業在正常情況下的工期（天）
   - **正常成本**：正常情況下的成本
   - **趕工工期**：作業趕工後的工期（天，必須 ≤ 正常工期）
   - **趕工成本**：趕工後的成本（必須 ≥ 正常成本）
   - **前置作業**：選擇此作業的前置作業（可多選）
4. 點擊「確定」儲存

**注意事項**：
- 趕工工期必須小於等於正常工期
- 趕工成本必須大於等於正常成本
- 前置作業關係不能形成循環（例如：A 的前置是 B，B 的前置是 A）
- 作業列表會顯示「正常工期／正常成本／趕工工期／趕工成本」四個欄位，方便即時比較各作業在不同模式下的差異

### 3. 執行優化計算

1. 進入「投標優化」頁面
2. 選擇要優化的專案
3. 選擇決策模式：
   - **模式一：給定預算，求最短工期**
     - 輸入預算約束金額
   - **模式二：給定工期，求最低成本**
     - 輸入工期約束（天）
4. （可選）設定獎懲條款：
   - **逾期違約金率**：逾期每日的違約金率
   - **趕工獎金率**：提前每日的獎金率
   - **目標工期**：用於計算獎懲的基準工期
5. 點擊「執行優化計算」
6. 等待計算完成，查看結果摘要

### 4. 查看詳細結果

1. 在優化結果區域，點擊「查看詳細結果與圖表」
2. 在結果分析頁面，您可以：
   - 查看完整的結果摘要
   - 查看甘特圖（作業排程視覺化）
   - 查看成本分析圖表
   - 查看作業排程明細表

### 5. 匯出報告

在結果分析頁面：
- **匯出 PDF**：點擊「匯出 PDF」按鈕，生成 PDF 報告
- **匯出 Excel**：點擊「匯出 Excel」按鈕，生成 Excel 報告

## 功能操作指南

### 專案管理

#### 編輯專案
1. 在專案列表中，點擊「編輯」按鈕
2. 修改專案資訊
3. 點擊「確定」儲存

#### 刪除專案
1. 在專案列表中，點擊「刪除」按鈕
2. 確認刪除操作
3. **注意**：刪除專案會同時刪除所有相關的作業活動和優化結果

### 作業活動管理

#### 編輯作業
1. 在作業列表中，點擊「編輯」按鈕
2. 修改作業資訊或前置關係
3. 點擊「確定」儲存

#### 刪除作業
1. 在作業列表中，點擊「刪除」按鈕
2. 確認刪除操作
3. **注意**：刪除作業會同時刪除相關的前置關係

### 優化計算

#### 模式一：給定預算，求最短工期

**適用情境**：當您有預算限制，想知道在此預算下能完成的最短工期。

**操作步驟**：
1. 選擇「模式一：給定預算，求最短工期」
2. 輸入預算約束金額
3. （可選）設定獎懲條款
4. 執行優化計算

**結果解讀**：
- **最優工期**：在預算約束下可達成的最短工期
- **最優成本**：實際使用的成本（可能小於預算）
- **總成本**：包含獎懲後的總成本

#### 模式二：給定工期，求最低成本

**適用情境**：當您有工期限制，想知道在此工期下所需的最低成本。

**操作步驟**：
1. 選擇「模式二：給定工期，求最低成本」
2. 輸入工期約束（天）
3. （可選）設定獎懲條款
4. 執行優化計算

**結果解讀**：
- **最優成本**：在工期約束下所需的最低成本
- **最優工期**：實際達成的工期（等於或小於約束工期）
- **總成本**：包含獎懲後的總成本

### 獎懲條款設定

#### 逾期違約金
- **違約金率**：逾期每日的違約金率（例如：0.01 表示每日違約金為總成本的 1%）
- **計算方式**：如果實際工期 > 目標工期，則違約金 = 違約金率 × (實際工期 - 目標工期) × 總成本

#### 趕工獎金
- **獎金率**：提前每日的獎金率（例如：0.005 表示每日獎金為總成本的 0.5%）
- **計算方式**：如果實際工期 < 目標工期，則獎金 = 獎金率 × (目標工期 - 實際工期) × 總成本

**範例**：
- 目標工期：100 天
- 違約金率：0.01（1%）
- 獎金率：0.005（0.5%）
- 實際工期：95 天
- 總成本：10,000,000 元

計算：
- 提前 5 天完成
- 獎金 = 0.005 × 5 × 10,000,000 = 250,000 元
- 總成本（含獎懲）= 10,000,000 - 250,000 = 9,750,000 元

## 常見問題

### Q1: 為什麼優化計算失敗？

**可能原因**：
1. **無可行解**：約束條件過於嚴格，無法找到可行方案
   - 解決方法：放寬預算或工期約束
2. **專案沒有作業活動**：專案尚未定義任何作業
   - 解決方法：先建立作業活動
3. **前置關係錯誤**：存在循環依賴
   - 解決方法：檢查並修正前置作業關係

### Q2: 如何判斷是否需要趕工？

系統會自動計算最優方案，決定哪些作業需要趕工。在結果中：
- **甘特圖**：紅色表示趕工作業，綠色表示正常作業
- **作業排程表**：「是否趕工」欄位標示

### Q3: 如何解讀甘特圖？

- **橫軸**：時間（天）
- **縱軸**：作業活動
- **條狀圖**：表示作業的開始時間和工期
- **顏色**：
  - 綠色：正常作業
  - 紅色：趕工作業

### Q4: 報告匯出失敗怎麼辦？

**可能原因**：
1. 瀏覽器阻擋下載
   - 解決方法：檢查瀏覽器下載設定
2. 檔案名稱包含特殊字元
   - 解決方法：系統會自動處理檔案名稱

### Q5: 可以修改已計算的優化結果嗎？

優化結果是根據當時的參數計算的，無法直接修改。如果需要調整：
1. 修改作業活動的參數（工期、成本）
2. 或修改優化參數（預算、工期約束、獎懲條款）
3. 重新執行優化計算

### Q6: 如何確保資料的正確性？

系統提供多層驗證：
1. **前端驗證**：輸入時即時檢查
2. **後端驗證**：提交時再次驗證
3. **資料庫約束**：資料庫層級的完整性檢查

建議：
- 仔細檢查作業活動的工期和成本設定
- 確認前置作業關係正確
- 驗證優化參數的合理性

## 技術支援

如有任何問題或建議，請聯繫系統管理員。

---

**版本**：1.0.0  
**最後更新**：2024年

